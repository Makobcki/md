data_root: ./data/raw/Danbooru
image_dir: image_512
meta_dir: meta
tags_dir: tags
caption_field: caption_llava_34b_no_tags_short
min_tag_count: 8
require_512: true
val_ratio: 0.01
cache_dir: .cache
failed_list: failed/md5.txt

seed: 42
out_dir: ./runs/danbooru_512

batch_size: 1
grad_accum_steps: 8
num_workers: 8
prefetch_factor: 4
pin_memory: true
persistent_workers: true

lr: 1.0e-4
weight_decay: 1.0e-4
max_steps: 120000
log_every: 50
save_every: 2000

timesteps: 1000
beta_start: 1.0e-4
beta_end: 2.0e-2
min_snr_gamma: 5.0
prediction_type: v

base_channels: 64
channel_mults: [1, 2, 3, 4]
num_res_blocks: 2
dropout: 0.10

attn_resolutions: [32, 16]
attn_heads: 4
attn_head_dim: 32

text_dim: 256
text_layers: 4
text_heads: 4
text_max_len: 128
text_vocab_path: diffusion/bpe/vocab.json
text_merges_path: diffusion/bpe/merges.txt
tokenizer_type: bpe
use_scale_shift_norm: true
grad_checkpointing: false

cond_drop_prob: 0.10

amp: true
amp_dtype: fp16
compile: false
compile_warmup_steps: 2
compile_cudagraphs: true
grad_clip_norm: 1.0
ema_decay: 0.999
resume_ckpt: ""
deterministic: false
tf32: true
cudnn_benchmark: true
channels_last: true
enable_flash_sdp: true
enable_mem_efficient_sdp: true
enable_math_sdp: false
mode: pixel
latent_channels: 4
latent_downsample_factor: 8
latent_cache: false
latent_cache_dir: .cache/latents
latent_dtype: bf16
latent_precompute: false
latent_cache_fallback: false
latent_cache_strict: true
vae_pretrained: ""
vae_freeze: true
vae_scaling_factor: 0.18215
ckpt_keep_last: 5
sanity_overfit_steps: 100
sanity_overfit_images: 2
sanity_overfit_max_loss: 0.1
